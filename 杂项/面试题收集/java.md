 

# java

## 1. 为什么线程池的submit不抛出异常？

提交方式为execute

![image-20221105221933483](assets/image-20221105221933483.png)



提交方式为execute

![image-20221105222130649](assets/image-20221105222130649.png)

会发现异常被吞了



因为内部确实把异常处理掉了



1. 

![image-20221105222833431](assets/image-20221105222833431.png)



2. ![image-20221105222949485](assets/image-20221105222949485.png)



3.  



![image-20221105223053471](assets/image-20221105223053471.png)



4.

![image-20221105223157383](assets/image-20221105223157383.png)



对于runnable，因为没有返回值，也不需要返回值，所以自然应该使用execute方法，这时候如果报错了就直接抛出来了。而对于callable，如果你也不需要它的返回值，那你就不应该使用submit而且execute了。但如果你需要返回值，那一定是submit，而且你后面也一定会调用future.get，错误也应该在这个时候返回给调用者。我认为这是一个正确的设计，而且正确的调用方式也应该是这样: 

**无所谓runnable还是callable，只要你不需要返回值，就execute，需要就submit。**



## 2.Java线程池的工作过程

![image-20221106111047148](assets/image-20221106111047148.png)

过程

![image-20221106112814502](assets/image-20221106112814502.png)

![image-20221106155451430](assets/image-20221106155451430.png)

## 3.线程池如何设置最优线程数

![image-20221106155624565](assets/image-20221106155624565.png)



![image-20221106155848923](assets/image-20221106155848923.png)



![image-20221106155930748](assets/image-20221106155930748.png)

### 实际调优



![image-20221106160229240](assets/image-20221106160229240.png)



![image-20221106160403116](assets/image-20221106160403116.png)



## 4.Java线程启动为什么调用start方法而不是run方法？



![image-20221106160703622](assets/image-20221106160703622.png)



![image-20221106160721855](assets/image-20221106160721855.png)



说白了就是run方法是个模版方法



通俗讲就是别人提供了一个功能，但其中的一个步骤需要你来实现，相当于别人定义好了一个功能的流程，但其中一个步骤需要你来补充，就是模板方法 。所以你实现的这个方法是被他的功能调用的。比如list提供的排序功能 需要你实现或者传一个比较器给它。只有它的功能调你的方法才对它的功能有意义。假如你实现了一个比较器 但是你不传给list的排序方法调用 那么这个比较器只是一个普通方法 没有意义。同理 你实现了一个run方法 但是不把它提供给线程功能来调用 当然也没法完成线程功能



## 5.如何在一亿个数中找出最大的1万个数？

1. 

![image-20221106162020651](assets/image-20221106162020651.png)

2. 

![image-20221106162152660](assets/image-20221106162152660.png)3.

![image-20221106162229287](assets/image-20221106162229287.png)

![image-20221106162325014](assets/image-20221106162325014.png)



## 6.如何从1000w记录中，找出最热门的10个记录？

![image-20221106180209852](assets/image-20221106180209852.png)

![image-20221106180441730](assets/image-20221106180441730.png)



## 7.Java中强应用、弱应用、软引用、虚引用的区别？



![image-20221106165438201](assets/image-20221106165438201.png)



![image-20221106165636617](assets/image-20221106165636617.png)



![image-20221106165929659](assets/image-20221106165929659.png)



![image-20221106170122063](assets/image-20221106170122063.png)



![image-20221106170238124](assets/image-20221106170238124.png)



## 8.为什么ThreadLocal会产生内存泄漏？





![image-20221106172236871](assets/image-20221106172236871.png)



![image-20221106172433993](assets/image-20221106172433993.png)



### 泄露是如何产生的

![image-20221106172523707](assets/image-20221106172523707.png)

其实我们常常所说的threadlocal的内存泄露指的是value的内存泄露，跟key的弱引用没关系，key的弱引用恰好是解决了key的内存泄露，但是解决不了value的内存泄露。所以，为了解决value的内存泄露，我们需要最后手动remove

### 如何解决



![image-20221106172833142](assets/image-20221106172833142.png)



## 9.说说HashMap的扩容算法

### 什么是

![image-20221106173121016](assets/image-20221106173121016.png)



![image-20221106173252612](assets/image-20221106173252612.png)



## 10.如何实现亿级用户登录态的数据统计？

![image-20221106181029255](assets/image-20221106181029255.png)



![image-20221106181105066](assets/image-20221106181105066.png)

### 比较好的

![image-20221106181126289](assets/image-20221106181126289.png)



## 11.什么是Java自旋锁？*



![image-20221106181539983](assets/image-20221106181539983.png)



![image-20221106181719010](assets/image-20221106181719010.png)

## 12.为什么Java中的main方法必须是public static void？

![image-20221106223941332](assets/image-20221106223941332.png)





![image-20221106224017776](assets/image-20221106224017776.png)



![image-20221106224057628](assets/image-20221106224057628.png)

## 13.Java线程池的拒绝策略有哪些？

![image-20221106224250125](assets/image-20221106224250125.png)

## 14.ThreadLocal的常用场景？

![image-20221107002114329](assets/image-20221107002114329.png)

![image-20221107002159863](assets/image-20221107002159863.png)

![image-20221107002237163](assets/image-20221107002237163.png)



![image-20221107002337351](assets/image-20221107002337351.png)



## 15.虚假唤醒问题！

![image-20221107004154123](assets/image-20221107004154123.png)

## 16.Java中的final有啥用？

![image-20221107004442041](assets/image-20221107004442041.png)





![image-20221107004547512](assets/image-20221107004547512.png)



![image-20221107004629874](assets/image-20221107004629874.png)



作用



![image-20221107004741610](assets/image-20221107004741610.png)

![image-20221107004827755](assets/image-20221107004827755.png)



## 17.为什么HashMap的负载因子是0.75？

![image-20221107004932869](assets/image-20221107004932869.png)



![image-20221107004959017](assets/image-20221107004959017.png)



## 18.Java如何优雅的中断线程？



### 1.中断

![image-20221107005206114](assets/image-20221107005206114.png)

### 2.标志位

![image-20221107005319519](assets/image-20221107005319519.png)

![image-20221107005353867](assets/image-20221107005353867.png)

## 19.两个一样数字的integer比较，竟然不相等？

![image-20221107005459801](assets/image-20221107005459801.png)

## 20.为什么大厂禁用Java内置线程池

### 什么是内置线程池

![image-20221107174403220](assets/image-20221107174403220.png)



### 特点

![image-20221107174758955](assets/image-20221107174758955.png)

### 建议使用

![image-20221107174842855](assets/image-20221107174842855.png)



## 21.Java日期格式化为什么一定要用小写y？

![image-20221107175759659](assets/image-20221107175759659.png)

### 实验

![image-20221107175822768](assets/image-20221107175822768.png)



d	1~31 (月份的第几天, 带0)
D	1~366 (年份的第几天,带0)

## 22.为什么不要使用Arrays.asList()？

![image-20221107180935257](assets/image-20221107180935257.png)



不能添加的匿名内部类
其实不到处乱传控制好使用范围的话倒也没什么不能使用的，一般也就是某个类因为业务临时要拦截某些特征码之类的东西会用一下，随便写个asList快速比对一下赶紧上线

## 23.为什么pojo的布尔类型不要用is开头？

说过布尔类型不能is开头，老的框架兼容不好，idea自动生成set/get方法会去掉开头的is

![image-20221107181133131](assets/image-20221107181133131.png)



![image-20221107181202467](assets/image-20221107181202467.png)

### 解决方案

![image-20221107181306062](assets/image-20221107181306062.png)



## 24.金融业务常用的bigdecimal要注意什么？

### vlaueof（）

![image-20221107183027733](assets/image-20221107183027733.png)



### 比较

![image-20221107183131425](assets/image-20221107183131425.png)

### 精度

![image-20221107183223031](assets/image-20221107183223031.png)

### tostring

![image-20221107183321345](assets/image-20221107183321345.png)

# 系统设计

## 1.秒杀系统如何解决超卖等常见问题？

![image-20221106225600567](assets/image-20221106225600567.png)



### 超卖



![image-20221106225648829](assets/image-20221106225648829.png)

### 少卖

![image-20221106225729430](assets/image-20221106225729430.png)



## 2.如何实现30分钟内未支付则取消订单？



### 1.定时

![image-20221106225849141](assets/image-20221106225849141.png)

### 2.mq

![image-20221106225947004](assets/image-20221106225947004.png)

## 3.如何避免订单重复提交和支付？

这类的问题可以归结为怎么保证接口的幂等性。

### 前端处理

![image-20221106232217134](assets/image-20221106232217134.png)

### token机制

![image-20221106232415606](assets/image-20221106232415606.png)



### 支付幂等

![image-20221106232548200](assets/image-20221106232548200.png)

![image-20221106232627271](assets/image-20221106232627271.png)



## 4.你用过什么分布式id算法？最优的是哪种？

### 背景

![image-20221106233802513](assets/image-20221106233802513.png)



### 算法



![image-20221106233903723](assets/image-20221106233903723.png)

![image-20221106233929941](assets/image-20221106233929941.png)

### 优点

![image-20221106234015169](assets/image-20221106234015169.png)

### 原理

![image-20221106234128046](assets/image-20221106234128046.png)



![image-20221106234203956](assets/image-20221106234203956.png)

### 优化

![image-20221106234325186](assets/image-20221106234325186.png)

## 5.你是如何实现限流算法的？（接口限流）

###  背景

![image-20221106234550236](assets/image-20221106234550236.png)

### 计数器

![image-20221106234723424](assets/image-20221106234723424.png)



![image-20221106234906018](assets/image-20221106234906018.png)

### 令牌桶

![image-20221106235113340](assets/image-20221106235113340.png)

### 漏桶

![image-20221106235214395](assets/image-20221106235214395.png)

## 6.日志最佳实践

![image-20221107000416501](assets/image-20221107000416501.png)



![image-20221107000521912](assets/image-20221107000521912.png)



## 7.ElasticSearch性能优化方案？

![image-20221107000703851](assets/image-20221107000703851.png)



![image-20221107000732953](assets/image-20221107000732953.png)

![image-20221107000801089](assets/image-20221107000801089.png)

![image-20221107000833286](assets/image-20221107000833286.png)

![image-20221107000925349](assets/image-20221107000925349.png)

## 8.使用TraceId实现线上问题定位！

### 背景

![image-20221107111738386](assets/image-20221107111738386.png)

![image-20221107111910085](assets/image-20221107111910085.png)

## 9.如何设计一个秒杀系统？

### 什么是

![image-20221107112148113](assets/image-20221107112148113.png)



### 特点

![image-20221107112416829](assets/image-20221107112416829.png)



![image-20221107112740332](assets/image-20221107112740332.png)



### 高并发

![image-20221107112916696](assets/image-20221107112916696.png)

### 超卖问题

![image-20221107112951031](assets/image-20221107112951031.png)

### 限流

![image-20221107113207048](assets/image-20221107113207048.png)

### 静态资源



![image-20221107113348803](assets/image-20221107113348803.png)

### 前端

![image-20221107113456511](assets/image-20221107113456511.png)



### 防刷子

![image-20221107113844259](assets/image-20221107113844259.png)

### 后处理



![image-20221107114028776](assets/image-20221107114028776.png)



![image-20221107114130668](assets/image-20221107114130668.png)

### 降级



![image-20221107114253986](assets/image-20221107114253986.png)

## 10.线上一亿数据，如何分表迁移？

### 背景

![image-20221107172119567](assets/image-20221107172119567.png)



### 如何迁移

![image-20221107172224074](assets/image-20221107172224074.png)

### 双写方案

![image-20221107172409981](assets/image-20221107172409981.png)





## 11.618的商品排行榜是如何实现的



### 什么是

![image-20221107172608973](assets/image-20221107172608973.png)



![image-20221107172741439](assets/image-20221107172741439.png)



### 数据库实现

![image-20221107172906957](assets/image-20221107172906957.png)

### 大数据



![image-20221107173015718](assets/image-20221107173015718.png)

### redis

![image-20221107173144698](assets/image-20221107173144698.png)



![image-20221107175155885](assets/image-20221107175155885.png)



## 12.百万并发抢券业务你如何设计？



### 背景

![image-20221107180229701](assets/image-20221107180229701.png)

### 问题



![image-20221107180428370](assets/image-20221107180428370.png)



![image-20221107180557881](assets/image-20221107180557881.png)

## 13.两个50亿的url找出相同url?这可能？

![image-20221107183941514](assets/image-20221107183941514.png)

1.

![image-20221107183958372](assets/image-20221107183958372.png)



![image-20221107184025001](assets/image-20221107184025001.png)



2.

![image-20221107184112470](assets/image-20221107184112470.png)



![image-20221107184135081](assets/image-20221107184135081.png)



## 14. 十万级发券业务性能瓶颈及解决方案？

#### 1.存储瓶颈

![image-20221207214828978](assets/image-20221207214828978.png)





![image-20221207215004264](assets/image-20221207215004264.png)







![image-20221207215254109](assets/image-20221207215254109.png)



#### 2. 失败解决问题



![image-20221207215501441](assets/image-20221207215501441.png)

![image-20221207215643179](assets/image-20221207215643179.png)
